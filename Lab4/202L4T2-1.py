import matplotlib.pyplot as plt

x = [0, 0.00002, 0.00004, 0.00008, 0.00016, 0.00032, 0.00064, 0.00128, 0.00256, 0.00456, 0.00656, 0.00856, 0.01056, 0.01256, 0.01456, 0.01656, 0.01856, 0.02056, 0.02256, 0.02456, 0.02656, 0.02856, 0.03056, 0.03256, 0.03456, 0.03656, 0.03856, 0.04056, 0.04256, 0.04456, 0.04656, 0.04856, 0.05056, 0.05256, 0.05456, 0.05656, 0.05856, 0.06056, 0.06256, 0.06456, 0.06656, 0.06856, 0.07056, 0.07256, 0.07456, 0.07656, 0.07856, 0.08056, 0.08256, 0.08456, 0.08656, 0.08856, 0.09056, 0.09256, 0.09456, 0.09656, 0.09856, 0.1] # Time
y1 = [0, 79.87234418, 79.74489223, 79.49039539, 78.98383632, 77.98037929, 76.01149927, 72.22113004, 65.19407117, 55.54774621, 47.33009326, 40.32951806, 34.36576463, 29.28527392, 24.9572298, 21.27019075, 18.12922037, 15.45344285, 13.17396055, 11.23207993, 9.577800318, 8.168526406, 6.967971488, 5.945223122, 5.073947171, 4.331709729, 3.699399476, 3.160735585, 2.701848511, 2.310922864, 1.977893179, 1.694184745, 1.452492809, 1.246594496, 1.071188572, 0.921758945, 0.794458382, 0.686009446, 0.593620106, 0.514911849, 0.447858431, 0.390733705, 0.342067177, 0.300606143, 0.265283428, 0.235189915, 0.20955113, 0.187707303, 0.169096381, 0.153239554, 0.139728924, 0.128217009, 0.118407787, 0.110049081, 0.102926061, 0.096855718, 0.091682143, 0.088440225] # Voltage across inductor
y2 = [0, 0.000139936, 0.000279808, 0.000559423, 0.001117889, 0.002231784, 0.004447618, 0.008832948, 0.01742949, 0.030442051, 0.043004816, 0.055184033, 0.067036138, 0.078609208, 0.089944201, 0.101076009, 0.112034356, 0.122844563, 0.133528201, 0.144103648, 0.154586559, 0.16499027, 0.175326143, 0.185603856, 0.195831656, 0.206016567, 0.216164572, 0.226280769, 0.236369503, 0.246434472, 0.256478828, 0.266505257, 0.276516046, 0.286513145, 0.296498213, 0.306472665, 0.316437707, 0.326394364, 0.336343513, 0.346285897, 0.356222153, 0.366152821, 0.376078362, 0.385999169, 0.395915577, 0.405827871, 0.415736294, 0.425641054, 0.435542326, 0.445440261, 0.455334989, 0.465226617, 0.47511524, 0.485000937, 0.494883776, 0.504763814, 0.514641102, 0.521751069] # Voltage across capacitor


fig, ax = plt.subplots()
ax.plot(x, y1, color="#D33F49")
ax.plot(x, y2, color="#5EB1BF", linewidth=2)

ax.set_facecolor('#EBEBEB')
ax.set_axisbelow(True)
[ax.spines[side].set_visible(False) for side in ax.spines]
ax.grid()
ax.grid(which='major', color='white', linewidth=1.2)
ax.grid(which='minor', color='white', linewidth=0.6)
ax.minorticks_on()
ax.margins(0, 0)
ax.set_xlabel('Time (s)', fontweight ='bold')
ax.set_ylabel('Voltage (V)', fontweight ='bold')
ax.set_title("Charging of an inductor and capacitor", fontweight ='bold')
ax.legend(["Voltage across inductor", "Voltage across capacitor"])

# Max voltage spike across inductor
max_voltage = max(y1)
time_at_max = x[y1.index(max_voltage)]
print(f"Maximum voltage spike across inductor: {max_voltage:.4f}V")
print(f"Time of voltage spike: {time_at_max:.8f}s")

# plt.show()
# plt.savefig("202L4T2-1-graph.png", format='png', dpi=2500, bbox_inches='tight')