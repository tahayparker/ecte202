import matplotlib.pyplot as plt

x = [0, 0.002, 0.004, 0.008, 0.016, 0.032, 0.064, 0.128, 0.221439313, 0.332307042, 0.495732098, 0.645659874, 0.804892889, 0.968197202, 1.114534251, 1.257122515, 1.415501837, 1.561950935, 1.729988423, 1.877093567, 2.019668385, 2.178706449, 2.325069829, 2.489471129, 2.636335918, 2.779068363, 2.938996565, 3.085473741, 3.245455176, 3.393421289, 3.534739517, 3.680538993, 3.833538021, 3.986261636, 4.151722982, 4.294943883, 4.437029897, 4.589971903, 4.737486776, 4.937486776, 5.093241659, 5.230715837, 5.381480921, 5.53137098, 5.693956751, 5.837151914, 5.979920203, 6.133049205, 6.279910841, 6.479910841, 6.634873821, 6.772383679, 6.923538921, 7.072753146, 7.236888877, 7.379758089, 7.521913839, 7.674853884, 7.821399648, 8.021399648, 8.179924923, 8.324526035, 8.480449123, 8.634403622, 8.806331622, 8.909283858, 9.032722772, 9.166737869, 9.330137781, 9.530137781, 9.730137781, 9.930137781, 10] # Time
y = [0, -23.98774825, -23.96339243, -23.89076691, -23.60553522, -22.50958827, -18.47986594, -4.98075619, 21.78822446, 54.94790647, 92.13129345, 109.5513348, 113.7692651, 110.0744564, 105.0219662, 101.1586843, 98.89682914, 98.38201, 98.77379484, 99.37077202, 99.83794329, 100.1202284, 100.1899863, 100.1497429, 100.0800092, 100.0231881, 99.98748479, 99.97781415, 99.98163104, 99.98976838, 99.99662138, 100.000903, 100.002528, 100.0023032, 100.0012938, 100.0004564, 99.99993367, 99.99971159, 99.99971954, 99.99985529, 99.99995965, 100.0000141, 100.0000357, 100.0000324, 100.0000184, 100.0000066, 99.99999915, 99.99999596, 99.99999604, 99.99999794, 99.9999994, 100.0000002, 100.0000005, 100.0000005, 100.0000003, 100.0000001, 99.99999999, 99.99999994, 99.99999994, 99.99999997, 99.99999999, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100] # Voltage

R = 6 # Resistance in ohms
L = 1 # Inductance in henries
C = 40 * 10**-3 # Capacitance in farads

fig, ax = plt.subplots()
ax.plot(x, y, color="#D33F49")

ax.set_facecolor('#EBEBEB')
ax.set_axisbelow(True)
[ax.spines[side].set_visible(False) for side in ax.spines]
ax.grid()
ax.grid(which='major', color='white', linewidth=1.2)
ax.grid(which='minor', color='white', linewidth=0.6)
ax.minorticks_on()
ax.margins(0, 0)
ax.set_xlabel('Time (s)', fontweight ='bold')
ax.set_ylabel('Voltage (V)', fontweight ='bold')
ax.set_title("Charging of a capacitor", fontweight ='bold')

threshold = 1e-1 # Threshold for voltage stabilization
for i in range(1, len(x)):
    if abs(y[i] - 100) < threshold and abs(y[i-1] - 100) < threshold:
        voltage_stabilized = y[i]
        stabilization_time = x[i]
        break

print("Voltage stabilized at:", voltage_stabilized)
print("Time at which voltage stabilized:", stabilization_time)
print("Samples taken:", len(x))
print("Alpha:", R / 2 * L)
print("Omega:", 1 / (L * C)**0.5)

# plt.show()
plt.savefig("202L4T1-graph.png", format='png', dpi=2500, bbox_inches='tight')